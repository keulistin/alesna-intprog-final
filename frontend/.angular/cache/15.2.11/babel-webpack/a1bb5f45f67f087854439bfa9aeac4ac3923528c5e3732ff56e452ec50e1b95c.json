{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { environment } from '@environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nconst baseUrl = `${environment.apiUrl}/accounts`;\nexport let AccountService = /*#__PURE__*/(() => {\n  class AccountService {\n    getAccountByUserId(userId) {\n      throw new Error('Method not implemented.');\n    }\n    constructor(router, http) {\n      this.router = router;\n      this.http = http;\n      // Add to AccountService\n      this.departmentsUrl = `${environment.apiUrl}/departments`;\n      // Add to AccountService\n      this.employeesUrl = `${environment.apiUrl}/employees`;\n      this.requestsUrl = `${environment.apiUrl}/requests`;\n      this.workflowsUrl = `${environment.apiUrl}/workflows`;\n      this.accountSubject = new BehaviorSubject(null);\n      this.account = this.accountSubject.asObservable();\n    }\n    get accountValue() {\n      return this.accountSubject.value;\n    }\n    login(email, password) {\n      return this.http.post(`${baseUrl}/authenticate`, {\n        email,\n        password\n      }, {\n        withCredentials: true\n      }).pipe(map(account => {\n        this.accountSubject.next(account);\n        this.startRefreshTokenTimer();\n        return account;\n      }));\n    }\n    logout() {\n      this.http.post(`${baseUrl}/revoke-token`, {}, {\n        withCredentials: true\n      }).subscribe();\n      this.stopRefreshTokenTimer();\n      this.accountSubject.next(null);\n      this.router.navigate(['/account/login']);\n    }\n    refreshToken() {\n      return this.http.post(`${baseUrl}/refresh-token`, {}, {\n        withCredentials: true\n      }).pipe(map(account => {\n        this.accountSubject.next(account);\n        this.startRefreshTokenTimer();\n        return account;\n      }));\n    }\n    register(account) {\n      return this.http.post(`${baseUrl}/register`, account);\n    }\n    verifyEmail(token) {\n      return this.http.post(`${baseUrl}/verify-email`, {\n        token\n      });\n    }\n    forgotPassword(email) {\n      return this.http.post(`${baseUrl}/forgot-password`, {\n        email\n      });\n    }\n    validateResetToken(token) {\n      return this.http.post(`${baseUrl}/validate-reset-token`, {\n        token\n      });\n    }\n    resetPassword(token, password, confirmPassword) {\n      return this.http.post(`${baseUrl}/reset-password`, {\n        token,\n        password,\n        confirmPassword\n      });\n    }\n    getAll() {\n      return this.http.get(baseUrl);\n    }\n    getById(id) {\n      return this.http.get(`${baseUrl}/${id}`);\n    }\n    create(params) {\n      return this.http.post(baseUrl, params);\n    }\n    getDepartmentById(id) {\n      return this.http.get(`${this.departmentsUrl}/${id}`);\n    }\n    createDepartment(params) {\n      return this.http.post(this.departmentsUrl, params);\n    }\n    updateDepartment(id, params) {\n      return this.http.put(`${this.departmentsUrl}/${id}`, params);\n    }\n    getAllDepartments() {\n      return this.http.get(this.departmentsUrl);\n    }\n    deleteDepartment(id) {\n      return this.http.delete(`${this.departmentsUrl}/${id}`);\n    }\n    getAllUsers() {\n      return this.http.get(`${baseUrl}/users`);\n    }\n    getEmployeeById(id) {\n      return this.http.get(`${this.employeesUrl}/${id}`);\n    }\n    createEmployee(params) {\n      return this.http.post(this.employeesUrl, params);\n    }\n    updateEmployee(id, params) {\n      return this.http.put(`${this.employeesUrl}/${id}`, params);\n    }\n    deleteEmployee(id) {\n      return this.http.delete(`${this.employeesUrl}/${id}`);\n    }\n    getRequestById(id) {\n      return this.http.get(`${this.requestsUrl}/${id}`);\n    }\n    createRequest(params) {\n      return this.http.post(this.requestsUrl, params);\n    }\n    updateRequest(id, params) {\n      return this.http.put(`${this.requestsUrl}/${id}`, params);\n    }\n    getAllRequests() {\n      return this.http.get(this.requestsUrl);\n    }\n    deleteRequest(id) {\n      return this.http.delete(`${this.requestsUrl}/${id}`);\n    }\n    getEmployeeWorkflows(employeeId) {\n      return this.http.get(`${this.workflowsUrl}/employee/${employeeId}`);\n    }\n    updateWorkflowStatus(workflowId, params) {\n      return this.http.put(`${this.workflowsUrl}/${workflowId}/status`, params);\n    }\n    update(id, params) {\n      return this.http.put(`${baseUrl}/${id}`, params).pipe(map(account => {\n        var _a;\n        // update the current account if it was updated\n        if (account.id === ((_a = this.accountValue) === null || _a === void 0 ? void 0 : _a.id)) {\n          // publish updated account to subscribers\n          const updatedAccount = Object.assign(Object.assign({}, this.accountValue), account);\n          this.accountSubject.next(updatedAccount);\n        }\n        return account;\n      }));\n    }\n    delete(id) {\n      return this.http.delete(`${baseUrl}/${id}`).pipe(map(x => {\n        var _a;\n        // auto logout if the logged in account deleted their own record\n        if (id === ((_a = this.accountValue) === null || _a === void 0 ? void 0 : _a.id)) {\n          this.logout();\n        }\n        return x;\n      }));\n    }\n    startRefreshTokenTimer() {\n      // parse json object from base64 encoded jwt token\n      const jwtToken = JSON.parse(atob(this.accountValue.jwtToken.split('.')[1]));\n      // set a timeout to refresh the token a minute before it expires\n      const expires = new Date(jwtToken.exp * 1000);\n      const timeout = expires.getTime() - Date.now() - 60 * 1000;\n      this.refreshTokenTimeout = setTimeout(() => this.refreshToken().subscribe(), timeout);\n    }\n    stopRefreshTokenTimer() {\n      clearTimeout(this.refreshTokenTimeout);\n    }\n  }\n  AccountService.ɵfac = function AccountService_Factory(t) {\n    return new (t || AccountService)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.HttpClient));\n  };\n  AccountService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AccountService,\n    factory: AccountService.ɵfac,\n    providedIn: 'root'\n  });\n  return AccountService;\n})();","map":{"version":3,"mappings":"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","names":["BehaviorSubject","map","environment","baseUrl","apiUrl","AccountService","getAccountByUserId","userId","Error","constructor","router","http","accountSubject","account","asObservable","accountValue","value","login","email","password","post","withCredentials","pipe","next","startRefreshTokenTimer","logout","subscribe","stopRefreshTokenTimer","navigate","refreshToken","register","verifyEmail","token","forgotPassword","validateResetToken","resetPassword","confirmPassword","getAll","get","getById","id","create","params","getDepartmentById","departmentsUrl","createDepartment","updateDepartment","put","getAllDepartments","deleteDepartment","delete","getAllUsers","getEmployeeById","employeesUrl","createEmployee","updateEmployee","deleteEmployee","getRequestById","requestsUrl","createRequest","updateRequest","getAllRequests","deleteRequest","getEmployeeWorkflows","employeeId","workflowsUrl","updateWorkflowStatus","workflowId","update","updatedAccount","x","jwtToken","JSON","parse","atob","split","expires","Date","exp","timeout","getTime","now","refreshTokenTimeout","setTimeout","clearTimeout","factory","providedIn"],"sourceRoot":"","sources":["E:\\semifinals\\groupB-fullstack-app\\frontend\\src\\app\\_services\\account.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { map, finalize } from 'rxjs/operators';\r\nimport { environment } from '@environments/environment';\r\nimport { Account } from '@app/_models';\r\n\r\nconst baseUrl = `${environment.apiUrl}/accounts`;\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class AccountService {\r\n    getAccountByUserId(userId: any) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    private accountSubject: BehaviorSubject<Account>;\r\n    public account: Observable<Account>;\r\n\r\n    constructor(\r\n        private router: Router,\r\n        private http: HttpClient\r\n    ) {\r\n        this.accountSubject = new BehaviorSubject<Account>(null);\r\n        this.account = this.accountSubject.asObservable();\r\n    }\r\n\r\n    public get accountValue(): Account {\r\n        return this.accountSubject.value;\r\n    }\r\n\r\n    login(email: string, password: string) {\r\n        return this.http.post<any>(`${baseUrl}/authenticate`, { email, password }, { withCredentials: true })\r\n            .pipe(map(account => {\r\n                this.accountSubject.next(account);\r\n                this.startRefreshTokenTimer();\r\n                return account;\r\n            }));\r\n    }\r\n\r\n    logout() {\r\n        this.http.post<any>(`${baseUrl}/revoke-token`, {}, { withCredentials: true }).subscribe();\r\n        this.stopRefreshTokenTimer();\r\n        this.accountSubject.next(null);\r\n        this.router.navigate(['/account/login']);\r\n    }\r\n\r\n    refreshToken() {\r\n        return this.http.post<any>(`${baseUrl}/refresh-token`, {}, { withCredentials: true })\r\n            .pipe(map((account) => {\r\n                this.accountSubject.next(account);\r\n                this.startRefreshTokenTimer();\r\n                return account;\r\n            }));\r\n    }\r\n\r\n    register(account: Account) {\r\n        return this.http.post(`${baseUrl}/register`, account);\r\n    }\r\n\r\n    verifyEmail(token: string) {\r\n        return this.http.post(`${baseUrl}/verify-email`, { token });\r\n    }\r\n\r\n    forgotPassword(email: string) {\r\n        return this.http.post(`${baseUrl}/forgot-password`, { email });\r\n    }\r\n\r\n    validateResetToken(token: string) {\r\n        return this.http.post(`${baseUrl}/validate-reset-token`, { token });\r\n    }\r\n\r\n    resetPassword(token: string, password: string, confirmPassword: string) {\r\n        return this.http.post(`${baseUrl}/reset-password`, { token, password, confirmPassword });\r\n    }\r\n\r\n    getAll(): Observable<Account[]> {\r\n        return this.http.get<Account[]>(baseUrl);\r\n    }\r\n\r\n    getById(id: string): Observable<Account> {\r\n        return this.http.get<Account>(`${baseUrl}/${id}`);\r\n    }\r\n\r\n    create(params: any): Observable<any> {\r\n        return this.http.post(baseUrl, params);\r\n    }\r\n\r\n    // Add to AccountService\r\n    private departmentsUrl = `${environment.apiUrl}/departments`;\r\n\r\n    getDepartmentById(id: string): Observable<any> {\r\n        return this.http.get(`${this.departmentsUrl}/${id}`);\r\n    }\r\n\r\n    createDepartment(params: any): Observable<any> {\r\n        return this.http.post(this.departmentsUrl, params);\r\n    }\r\n\r\n    updateDepartment(id: string, params: any): Observable<any> {\r\n        return this.http.put(`${this.departmentsUrl}/${id}`, params);\r\n    }\r\n    getAllDepartments(): Observable<any[]> {\r\n        return this.http.get<any[]>(this.departmentsUrl);\r\n    }\r\n\r\n    deleteDepartment(id: string): Observable<any> {\r\n        return this.http.delete(`${this.departmentsUrl}/${id}`);\r\n    }\r\n\r\n    // Add to AccountService\r\n    private employeesUrl = `${environment.apiUrl}/employees`;\r\n\r\n    getAllUsers(): Observable<any[]> {\r\n        return this.http.get<any[]>(`${baseUrl}/users`);\r\n    }\r\n\r\n    getEmployeeById(id: string): Observable<any> {\r\n        return this.http.get(`${this.employeesUrl}/${id}`);\r\n    }\r\n\r\n    createEmployee(params: any): Observable<any> {\r\n        return this.http.post(this.employeesUrl, params);\r\n    }\r\n\r\n    updateEmployee(id: string, params: any): Observable<any> {\r\n        return this.http.put(`${this.employeesUrl}/${id}`, params);\r\n    }\r\n    deleteEmployee(id: string): Observable<any> {\r\n        return this.http.delete(`${this.employeesUrl}/${id}`);\r\n    }\r\n\r\n    private requestsUrl = `${environment.apiUrl}/requests`;\r\n\r\n    getRequestById(id: string): Observable<any> {\r\n        return this.http.get(`${this.requestsUrl}/${id}`);\r\n    }\r\n\r\n    createRequest(params: any): Observable<any> {\r\n        return this.http.post(this.requestsUrl, params);\r\n    }\r\n\r\n    updateRequest(id: string, params: any): Observable<any> {\r\n        return this.http.put(`${this.requestsUrl}/${id}`, params);\r\n    }\r\n\r\n    getAllRequests(): Observable<any[]> {\r\n        return this.http.get<any[]>(this.requestsUrl);\r\n    }\r\n\r\n    deleteRequest(id: string): Observable<any> {\r\n        return this.http.delete(`${this.requestsUrl}/${id}`);\r\n    }\r\n    private workflowsUrl = `${environment.apiUrl}/workflows`;\r\n\r\n    getEmployeeWorkflows(employeeId: string): Observable<any[]> {\r\n        return this.http.get<any[]>(`${this.workflowsUrl}/employee/${employeeId}`);\r\n    }\r\n\r\n    updateWorkflowStatus(workflowId: string, params: any): Observable<any> {\r\n        return this.http.put(`${this.workflowsUrl}/${workflowId}/status`, params);\r\n    }\r\n    update(id: string, params: any): Observable<Account> {\r\n        return this.http.put(`${baseUrl}/${id}`, params)\r\n            .pipe(map((account: Account) => {\r\n                // update the current account if it was updated\r\n                if (account.id === this.accountValue?.id) {\r\n                    // publish updated account to subscribers\r\n                    const updatedAccount = { ...this.accountValue, ...account };\r\n                    this.accountSubject.next(updatedAccount);\r\n                }\r\n                return account;\r\n            }));\r\n    }\r\n\r\n    delete(id: string) {\r\n        return this.http.delete(`${baseUrl}/${id}`)\r\n            .pipe(map(x => {\r\n                // auto logout if the logged in account deleted their own record\r\n                if (id === this.accountValue?.id) {\r\n                    this.logout();\r\n                }\r\n                return x;\r\n            }));\r\n    }\r\n\r\n\r\n    // helper methods\r\n    private refreshTokenTimeout: any;\r\n\r\n    private startRefreshTokenTimer() {\r\n        // parse json object from base64 encoded jwt token\r\n        const jwtToken = JSON.parse(atob(this.accountValue.jwtToken.split('.')[1]));\r\n\r\n        // set a timeout to refresh the token a minute before it expires\r\n        const expires = new Date(jwtToken.exp * 1000);\r\n        const timeout = expires.getTime() - Date.now() - (60 * 1000);\r\n        this.refreshTokenTimeout = setTimeout(() => this.refreshToken().subscribe(), timeout);\r\n    }\r\n\r\n    private stopRefreshTokenTimer() {\r\n        clearTimeout(this.refreshTokenTimeout);\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}