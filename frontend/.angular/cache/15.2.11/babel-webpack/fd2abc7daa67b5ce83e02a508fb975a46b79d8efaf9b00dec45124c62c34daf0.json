{"ast":null,"code":"import { first } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@app/_services\";\nimport * as i2 from \"@angular/common\";\nfunction ListComponent_tr_17_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function ListComponent_tr_17_button_10_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const dept_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.delete(dept_r2.id));\n    });\n    i0.ɵɵtext(1, \"Delete\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListComponent_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function ListComponent_tr_17_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const dept_r2 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.edit(dept_r2.id));\n    });\n    i0.ɵɵtext(9, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, ListComponent_tr_17_button_10_Template, 2, 0, \"button\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const dept_r2 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_3_0;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dept_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dept_r2.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(dept_r2.employeeCount);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx_r0.account()) == null ? null : tmp_3_0.role) === \"Admin\");\n  }\n}\nfunction ListComponent_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function ListComponent_button_18_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.add());\n    });\n    i0.ɵɵtext(1, \"Add Department\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let ListComponent = /*#__PURE__*/(() => {\n  class ListComponent {\n    constructor(departmentService, employeeService, alertService) {\n      this.departmentService = departmentService;\n      this.employeeService = employeeService;\n      this.alertService = alertService;\n      this.departments = [];\n      this.departmentToDelete = null;\n      this.showDeleteModal = false;\n    }\n    ngOnInit() {\n      this.loadDepartmentsWithEmployeeCounts();\n    }\n    loadDepartmentsWithEmployeeCounts() {\n      // First load all departments\n      this.departmentService.getAll().pipe(first()).subscribe(departments => {\n        this.departments = departments;\n        // Then load all employees to count department assignments\n        this.employeeService.getAll().pipe(first()).subscribe(employees => {\n          // Calculate employee count for each department\n          this.departments.forEach(dept => {\n            dept.employeeCount = employees.filter(emp => emp.departmentId.toString() === dept.id.toString()).length;\n          });\n        });\n      });\n    }\n    openDeleteModal(department) {\n      this.departmentToDelete = department;\n      this.showDeleteModal = true;\n      document.body.classList.add('modal-open');\n    }\n    confirmDelete() {\n      if (!this.departmentToDelete) return;\n      const department = this.departmentToDelete;\n      department.isDeleting = true;\n      this.departmentService.delete(department.id).pipe(first()).subscribe({\n        next: () => {\n          this.departments = this.departments.filter(x => x.id !== department.id);\n          this.alertService.success('Department deleted successfully');\n          this.closeDeleteModal();\n        },\n        error: error => {\n          this.alertService.error(error);\n          department.isDeleting = false;\n          this.closeDeleteModal();\n        }\n      });\n    }\n    closeDeleteModal() {\n      this.showDeleteModal = false;\n      document.body.classList.remove('modal-open');\n      this.departmentToDelete = null;\n    }\n  }\n  ListComponent.ɵfac = function ListComponent_Factory(t) {\n    return new (t || ListComponent)(i0.ɵɵdirectiveInject(i1.DepartmentService), i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i1.AlertService));\n  };\n  ListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ListComponent,\n    selectors: [[\"ng-component\"]],\n    decls: 19,\n    vars: 2,\n    consts: [[1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"btn btn-primary float-end\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-sm\", \"btn-primary\", \"me-1\", 3, \"click\"], [\"class\", \"btn btn-sm btn-danger\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-sm\", \"btn-danger\", 3, \"click\"], [1, \"btn\", \"btn-primary\", \"float-end\", 3, \"click\"]],\n    template: function ListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtext(2, \"Departments\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3)(5, \"table\", 4)(6, \"thead\")(7, \"tr\")(8, \"th\");\n        i0.ɵɵtext(9, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"th\");\n        i0.ɵɵtext(11, \"Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"th\");\n        i0.ɵɵtext(13, \"Employee Count\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"th\");\n        i0.ɵɵtext(15, \"Actions\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"tbody\");\n        i0.ɵɵtemplate(17, ListComponent_tr_17_Template, 11, 4, \"tr\", 5);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(18, ListComponent_button_18_Template, 2, 0, \"button\", 6);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        let tmp_1_0;\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngForOf\", ctx.departments);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_1_0 = ctx.account()) == null ? null : tmp_1_0.role) === \"Admin\");\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf],\n    styles: [\".modal-backdrop[_ngcontent-%COMP%] {\\n            position: fixed;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n            background-color: rgba(0, 0, 0, 0.5);\\n            z-index: 1040;\\n        }\\n        .modal[_ngcontent-%COMP%] {\\n            position: fixed;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n            z-index: 1050;\\n            overflow: auto;\\n            display: flex;\\n            align-items: center;\\n            justify-content: center;\\n        }\\n        .modal-dialog[_ngcontent-%COMP%] {\\n            width: 100%;\\n            max-width: 500px;\\n            margin: 1.75rem auto;\\n            position: relative;\\n        }\\n        .modal-content[_ngcontent-%COMP%] {\\n            position: relative;\\n            background-color: #fff;\\n            border-radius: 0.3rem;\\n            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5);\\n        }\\n        .modal-header[_ngcontent-%COMP%] {\\n            display: flex;\\n            align-items: center;\\n            justify-content: space-between;\\n            padding: 1rem;\\n            background-color: #f8f9fa;\\n            border-bottom: 1px solid #e9ecef;\\n            border-top-left-radius: 0.3rem;\\n            border-top-right-radius: 0.3rem;\\n        }\\n        .modal-body[_ngcontent-%COMP%] {\\n            padding: 1rem;\\n        }\\n        .modal-footer[_ngcontent-%COMP%] {\\n            display: flex;\\n            align-items: center;\\n            justify-content: flex-end;\\n            padding: 1rem;\\n            border-top: 1px solid #e9ecef;\\n        }\\n        .btn-close[_ngcontent-%COMP%] {\\n            background: transparent;\\n            border: 0;\\n            font-size: 1.5rem;\\n            font-weight: 700;\\n            color: #000;\\n            opacity: 0.5;\\n            cursor: pointer;\\n        }\\n        .show[_ngcontent-%COMP%] {\\n            display: flex !important;\\n        }\\n        .hide[_ngcontent-%COMP%] {\\n            display: none !important;\\n        }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZGVwYXJ0bWVudHMvbGlzdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtRQUNRO1lBQ0ksZUFBZTtZQUNmLE1BQU07WUFDTixPQUFPO1lBQ1AsV0FBVztZQUNYLFlBQVk7WUFDWixvQ0FBb0M7WUFDcEMsYUFBYTtRQUNqQjtRQUNBO1lBQ0ksZUFBZTtZQUNmLE1BQU07WUFDTixPQUFPO1lBQ1AsV0FBVztZQUNYLFlBQVk7WUFDWixhQUFhO1lBQ2IsY0FBYztZQUNkLGFBQWE7WUFDYixtQkFBbUI7WUFDbkIsdUJBQXVCO1FBQzNCO1FBQ0E7WUFDSSxXQUFXO1lBQ1gsZ0JBQWdCO1lBQ2hCLG9CQUFvQjtZQUNwQixrQkFBa0I7UUFDdEI7UUFDQTtZQUNJLGtCQUFrQjtZQUNsQixzQkFBc0I7WUFDdEIscUJBQXFCO1lBQ3JCLDRDQUE0QztRQUNoRDtRQUNBO1lBQ0ksYUFBYTtZQUNiLG1CQUFtQjtZQUNuQiw4QkFBOEI7WUFDOUIsYUFBYTtZQUNiLHlCQUF5QjtZQUN6QixnQ0FBZ0M7WUFDaEMsOEJBQThCO1lBQzlCLCtCQUErQjtRQUNuQztRQUNBO1lBQ0ksYUFBYTtRQUNqQjtRQUNBO1lBQ0ksYUFBYTtZQUNiLG1CQUFtQjtZQUNuQix5QkFBeUI7WUFDekIsYUFBYTtZQUNiLDZCQUE2QjtRQUNqQztRQUNBO1lBQ0ksdUJBQXVCO1lBQ3ZCLFNBQVM7WUFDVCxpQkFBaUI7WUFDakIsZ0JBQWdCO1lBQ2hCLFdBQVc7WUFDWCxZQUFZO1lBQ1osZUFBZTtRQUNuQjtRQUNBO1lBQ0ksd0JBQXdCO1FBQzVCO1FBQ0E7WUFDSSx3QkFBd0I7UUFDNUIiLCJzb3VyY2VzQ29udGVudCI6WyJcbiAgICAgICAgLm1vZGFsLWJhY2tkcm9wIHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwNDA7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsIHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwNTA7XG4gICAgICAgICAgICBvdmVyZmxvdzogYXV0bztcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWRpYWxvZyB7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIG1heC13aWR0aDogNTAwcHg7XG4gICAgICAgICAgICBtYXJnaW46IDEuNzVyZW0gYXV0bztcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgfVxuICAgICAgICAubW9kYWwtY29udGVudCB7XG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMC4zcmVtO1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwLjVyZW0gMXJlbSByZ2JhKDAsIDAsIDAsIDAuNSk7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWhlYWRlciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOWZhO1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlOWVjZWY7XG4gICAgICAgICAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAwLjNyZW07XG4gICAgICAgICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMC4zcmVtO1xuICAgICAgICB9XG4gICAgICAgIC5tb2RhbC1ib2R5IHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWZvb3RlciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gICAgICAgICAgICBwYWRkaW5nOiAxcmVtO1xuICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlOWVjZWY7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0bi1jbG9zZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgICAgIGJvcmRlcjogMDtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS41cmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDtcbiAgICAgICAgICAgIGNvbG9yOiAjMDAwO1xuICAgICAgICAgICAgb3BhY2l0eTogMC41O1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB9XG4gICAgICAgIC5zaG93IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgICAgICAuaGlkZSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICAiXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n  return ListComponent;\n})();","map":{"version":3,"mappings":"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","names":["first","i0","ListComponent","constructor","departmentService","employeeService","alertService","ngOnInit","loadDepartmentsWithEmployeeCounts","getAll","pipe","subscribe","departments","employees","forEach","dept","employeeCount","filter","emp","departmentId","toString","id","length","openDeleteModal","department","departmentToDelete","showDeleteModal","document","body","classList","add","confirmDelete","isDeleting","delete","next","x","success","closeDeleteModal","error","remove","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["E:\\semifinals\\groupB-fullstack-app\\frontend\\src\\app\\departments\\list.component.ts","E:\\semifinals\\groupB-fullstack-app\\frontend\\src\\app\\departments\\list.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { first } from 'rxjs/operators';\r\n\r\nimport { DepartmentService, AlertService, EmployeeService } from '@app/_services';\r\nimport { Department } from '@app/_models/department';\r\n\r\n@Component({\r\n    templateUrl: 'list.component.html',\r\n    styles: [`\r\n        .modal-backdrop {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background-color: rgba(0, 0, 0, 0.5);\r\n            z-index: 1040;\r\n        }\r\n        .modal {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            z-index: 1050;\r\n            overflow: auto;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        .modal-dialog {\r\n            width: 100%;\r\n            max-width: 500px;\r\n            margin: 1.75rem auto;\r\n            position: relative;\r\n        }\r\n        .modal-content {\r\n            position: relative;\r\n            background-color: #fff;\r\n            border-radius: 0.3rem;\r\n            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5);\r\n        }\r\n        .modal-header {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n            padding: 1rem;\r\n            background-color: #f8f9fa;\r\n            border-bottom: 1px solid #e9ecef;\r\n            border-top-left-radius: 0.3rem;\r\n            border-top-right-radius: 0.3rem;\r\n        }\r\n        .modal-body {\r\n            padding: 1rem;\r\n        }\r\n        .modal-footer {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: flex-end;\r\n            padding: 1rem;\r\n            border-top: 1px solid #e9ecef;\r\n        }\r\n        .btn-close {\r\n            background: transparent;\r\n            border: 0;\r\n            font-size: 1.5rem;\r\n            font-weight: 700;\r\n            color: #000;\r\n            opacity: 0.5;\r\n            cursor: pointer;\r\n        }\r\n        .show {\r\n            display: flex !important;\r\n        }\r\n        .hide {\r\n            display: none !important;\r\n        }\r\n    `]\r\n})\r\nexport class ListComponent implements OnInit {\r\n    departments: Department[] = [];\r\n    departmentToDelete = null;\r\n    showDeleteModal = false;\r\n\r\n    constructor(\r\n        private departmentService: DepartmentService,\r\n        private employeeService: EmployeeService,\r\n        private alertService: AlertService\r\n    ) { }\r\n\r\n    ngOnInit() {\r\n        this.loadDepartmentsWithEmployeeCounts();\r\n    }\r\n\r\n    private loadDepartmentsWithEmployeeCounts() {\r\n        // First load all departments\r\n        this.departmentService.getAll()\r\n            .pipe(first())\r\n            .subscribe(departments => {\r\n                this.departments = departments;\r\n\r\n                // Then load all employees to count department assignments\r\n                this.employeeService.getAll()\r\n                    .pipe(first())\r\n                    .subscribe(employees => {\r\n                        // Calculate employee count for each department\r\n                        this.departments.forEach(dept => {\r\n                            dept.employeeCount = employees.filter(emp =>\r\n                                emp.departmentId.toString() === dept.id.toString()\r\n                            ).length;\r\n                        });\r\n                    });\r\n            });\r\n    }\r\n\r\n    openDeleteModal(department) {\r\n        this.departmentToDelete = department;\r\n        this.showDeleteModal = true;\r\n        document.body.classList.add('modal-open');\r\n    }\r\n\r\n    confirmDelete() {\r\n        if (!this.departmentToDelete) return;\r\n\r\n        const department = this.departmentToDelete;\r\n        department.isDeleting = true;\r\n\r\n        this.departmentService.delete(department.id)\r\n            .pipe(first())\r\n            .subscribe({\r\n                next: () => {\r\n                    this.departments = this.departments.filter(x => x.id !== department.id);\r\n                    this.alertService.success('Department deleted successfully');\r\n                    this.closeDeleteModal();\r\n                },\r\n                error: error => {\r\n                    this.alertService.error(error);\r\n                    department.isDeleting = false;\r\n                    this.closeDeleteModal();\r\n                }\r\n            });\r\n    }\r\n\r\n    closeDeleteModal() {\r\n        this.showDeleteModal = false;\r\n        document.body.classList.remove('modal-open');\r\n        this.departmentToDelete = null;\r\n    }\r\n} ","<div class=\"card\">\r\n    <div class=\"card-header\">Departments</div>\r\n    <div class=\"card-body\">\r\n        <div class=\"table-responsive\">\r\n            <table class=\"table table-striped\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Name</th>\r\n                        <th>Description</th>\r\n                        <th>Employee Count</th>\r\n                        <th>Actions</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr *ngFor=\"let dept of departments\">\r\n                        <td>{{dept.name}}</td>\r\n                        <td>{{dept.description}}</td>\r\n                        <td>{{dept.employeeCount}}</td>\r\n                        <td>\r\n                            <button class=\"btn btn-sm btn-primary me-1\" (click)=\"edit(dept.id)\">Edit</button>\r\n                            <button *ngIf=\"account()?.role === 'Admin'\" class=\"btn btn-sm btn-danger\" (click)=\"delete(dept.id)\">Delete</button>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <button *ngIf=\"account()?.role === 'Admin'\" class=\"btn btn-primary float-end\" (click)=\"add()\">Add Department</button>\r\n    </div>\r\n</div>  "]},"metadata":{},"sourceType":"module","externalDependencies":[]}